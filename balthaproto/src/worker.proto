syntax = "proto3";

package worker;

service NodeTypeService {
  rpc GetNodeType (NodeTypeRequest) returns (NodeTypeAnswer);
}

enum NodeType {
 MANAGER = 0;
 WORKER = 1;
}

message NodeTypeRequest {}
message NodeTypeAnswer {
 NodeType node_type = 1;
}

message ManagerRequest {}
message ManagerAnswer {
    bool accepted = 1;
}
// When a node receives a message which can only be sent to a worker
// from its registered manager.
message NotMyManager {}

message ExecuteTask {
 bytes job_addr = 1;
 int32 argument = 2;
}
message TaskResult {
 int32 result = 1;
}

message WorkerMsgWrapper {
 oneof msg {
   NodeTypeRequest node_type_request = 1;
   NodeTypeAnswer node_type_answer = 2;
   ManagerRequest manager_request = 3;
   ManagerAnswer manager_answer = 4;
   NotMyManager not_my_manager = 5;
   ExecuteTask execute_task = 6;
   TaskResult task_result = 7;
 }
}
